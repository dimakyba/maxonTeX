\documentclass[a5paper,10pt,intlimits,twoside,nohref]{vpcku}
\usepackage{amsmath,amssymb,amsthm,delarray,enumerate}
\usepackage[mathscr]{eucal}
%\usepackage{a4wide}
\usepackage{amsopn}
%\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[ukrainian]{babel}
\usepackage{hyperref}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{multirow}
\usepackage{letterspace}
\usepackage{graphicx}


% Correct Russian hyphenation
\frenchspacing \righthyphenmin=2 \lefthyphenmin=2

\allowdisplaybreaks
\everymath{\displaystyle}

\DeclareMathOperator*{\limit}{l.i.m.}
\DeclareMathOperator{\diag}{diag} \DeclareMathOperator{\cov}{cov}
\DeclareMathOperator{\spo}{sp}

\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathsf{E}}
\renewcommand{\P}{\mathrm{P}}
\newcommand{\F}{\mathscr{F}}
\renewcommand{\C}{\mathbb{C}}
\newcommand{\Exp}{\mathrm{Exp}}
\newcommand{\Er}{\mathrm{E}}
\newcommand{\Sub}{\mathrm{Sub}}

\newtheorem{teo}{Теорема}%[section]
\newtheorem{lem}{Лема}%[section]
\newtheorem{coll}{Наслідок}%[section]
\theoremstyle{definition}
\newtheorem{defin}{Означення}%[section]
\newtheorem{exa}{Приклад}%[section]
\theoremstyle{remark}
\newtheorem{rem}{Зауваження}%[section]

\renewcommand{\baselinestretch}{1.3}

%\hfuzz7pt \voffset-1cm \hoffset-3cm \topmargin.4cm

\numberwithin{equation}{section}
\renewcommand{\thesection}{\arabic{section}}% zakommentirovat', esli nuzhno%
\renewcommand{\theequation}{\arabic{equation}}
%видаляє проблему з номером сторінки
\makeatletter
\renewcommand\chapter{
                    \clearpage
                    \global\@topnum\z@
                    \@afterindentfalse
                    \secdef\@chapter\@schapter}

\begin{document}
\renewcommand{\contentsname}{ЗМІСТ}
{\pagestyle{empty} \tableofcontents} \pagestyle{fancy}
\fancyhead{} % clear all header fields
\fancyfoot[LE,RO]{\small \thepage} \fancyfoot[C]{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}




\newpage
\chapter{Задачі мережевої оптимізації}
\section{Задачі визначення найкоротшого шляху}
Метод пошуку найкоротшого шляху. Розглянемо застосування мережевого підходу до вирішення задачі, мета якої полягає в знаходженні найкоротшого шляху в мережі. Покажемо, як розв'язати цю задачу, взявши в якості прикладу ситуацію, з якою стикнулася певна будівельна компанія "Інвест". Ця компанія реалізує кілька будівельних проектів у трьох районах. Будівництво ведеться на достатньо великій відстані (до 50 км) від місцеположення компанії. Витрати на численні щоденні перевезення персоналу, обладнання, матеріалів до об'єктів будівництва і назад значні. Відносно кожного будівельного об'єкту альтернативи транспортних зв'язків з компанією можуть бути представлені мережею доріг, вулиць та шосе. Мережа, показана на рис. 1.1, відображає варіанти перевезень до шести об'єктів будівництва компанії "Інвест" та від них.
\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot001}
	\caption{}
	\label{fig:screenshot001}
\end{figure}

Вузли мережі відповідають місцезнаходженню компанії (вузол 1) та об'єктів будівництва. Дороги, вулиці та шосе представлені дугами мережі. Відстані між об'єктами показані над дугами. Зверніть увагу, що довжини дуг не обов'язково пропорційні відстаням.

Фірма "Інвест" хотіла б визначити шляхи, які б мінімізували загальну відстань від місцезнаходження компанії до кожного об'єкта. Щоб вирішити цю проблему, нам необхідно визначити найкоротший шлях від фірми (вузла 1) до кожного з інших вузлів у мережі. Метод, який ми розглянемо, є процедурою присвоєння міток, призначеною для знаходження найкоротшої відстані від вузла 1 до всіх інших вузлів. Виконуючи кроки процедури присвоєння міток, ми будемо присвоювати кожному вузлу мітку, що складається з двох чисел, взятих у дужки. Перше число відображає відстань від вузла 1 до даного вузла, а друге - номер попереднього вузла на шляху від вузла 1 до цього вузла. Ми запишемо мітки для кожного вузла безпосередньо над ним або під ним.

На певному кроці процедури присвоєння міток про певний вузол можна сказати, що він або позначений, або не позначений міткою. Позначений вузол - це вузол, для якого ми визначили шлях від вузла 1, а для непозначеного вузла ми поки що такого шляху не визначили. Щодо будь-якого позначеного вузла ми можемо сказати, що цей вузол має або постійну, або тимчасову мітку. Якщо метод визначив найкоротшу відстань від вузла 1 до даного вузла, то про цей вузол кажуть, що йому присвоєна постійна мітка (відповідний пункт затемнений). Якщо найкоротший шлях від вузла 1 до даного вузла ще не визначений, то про цей вузол кажуть, що йому присвоєна тимчасова мітка (для її позначення використовуються прямокутні дужки [ ]).

Тепер, коли ми знаємо, що представляють собою мітки, розглянемо, як вони розраховуються та як процес присвоєння міток може бути використаний для визначення найкоротшого шляху від вузла 1 до кожного з усіх інших вузлів мережі. 

Ми розпочнемо процес маркування з присвоєння постійної мітки вузлу 1. Літера 5 означає, що вузол 1 є початковим, стартовим вузлом, а 0 означає, що відстань між вузлом 1 і самим собою дорівнює нулю. 

Початкові позначення на мережі фірми "Інвест" показані на рис. 1.2. Постійна мітка присвоєна лише вузлу 1. 

Щоб виконати перший крок (або ітерацію) процедури присвоєння міток, ми повинні розглянути кожен вузол, до якого можна потрапити безпосередньо з вузла 1; у цьому випадку ми бачимо вузли 2 і 3. Спочатку розглянемо вузол 2. Ми бачимо, що пряма відстань від вузла 1 до вузла 2 складає 15 км. Тоді вузлу 2 може бути присвоєна тимчасова мітка [15, 1]. Перше число означає, що до вузла 2 можна потрапити, подолавши 15 км, а друге число вказує на те, що попереднім вузлом на шляху є вузол 1. Потім, розглянувши так само вузол 3, ми можемо присвоїти йому мітку [10,1].

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot002}
	\caption{}
	\label{fig:screenshot002}
\end{figure}

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot003}
	\caption{}
	\label{fig:screenshot003}
\end{figure}
Часові мітки для вузлів 2 і 3 вказані на рис. 1.3. Тепер ми можемо розглянути всі вузли з часовими мітками і вибрати вузол з мінімальною відстанню, зображеною на мітці. Обираємо вузол 3. Часова мітка для цього вузла показує, що ми можемо досягти вузла 3 з вузла 1, подолавши відстань у 10 км. Чи можемо ми досягти вузла 3 шляхом коротшого маршруту? Оскільки будь-який інший шлях до вузла 3 вимагатиме проходження через інші вузли, і оскільки відстань від вузла 1 до всіх інших вузлів більше або рівне 10, то коротший шлях до вузла 3 не може бути знайдений шляхом проходження через будь-які інші вузли. Отже, ми визначили найкоротшу відстань до вузла 3 і відповідно можемо присвоїти цьому вузлу постійну мітку. Це означає, що ми можемо переходити до наступного кроку процедури, виходячи з вузла 3. Отримана ситуація показана на рис. 1.4.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot004}
	\caption{}
	\label{fig:screenshot004}
\end{figure}

Вузлу 3 присвоєно постійна мітка.

Далі ми переходимо до розгляду всіх вузлів, які ще не мають постійних міток і безпосередньо пов'язані з вузлом 3, тобто ми розглядаємо вузли 2 і 5. Ми можемо досягти вузла 2, подолавши 10+3=13 км, а вузла 5 — подолавши 10+4=14 км. Тимчасова мітка для вузла 2 змінюється на [13,3], і це означає, що ми знайшли новий шлях від вузла 1 до вузла 2 з відстанню 13 км і що попередній вузол на шляху до вузла 2 є вузол 3. Відповідно, вузлу 5 ми присвоюємо тимчасову мітку [14,3]. На рис.1.5 відображені результати обчислень на цьому етапі.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot005}
	\caption{}
	\label{fig:screenshot005}
\end{figure}

Тепер розглянемо всі вузли з часовими мітками і оберемо той, у якого найкоротша відстань у позначенні. З рисунку 1.5 видно, що це мітка при вузлі 2 з відстанню 13 км. Тепер вона стає постійною, і ми знаємо, що з вузла 1 її можна досягти через вузол 3, а відстань в 13 км є найкоротшою між пунктами 1 та 2.

Наступний крок, або ітерація, розпочинається в вузлі 2, останньому, позначеному постійною міткою. Як і раніше, ми розглядаємо кожен вузол з непостійною міткою, безпосередньо пов'язаний з вузлом 2, тобто вузли 4 і 7. Починаючи з відстані в 13 км у постійній мітці вузла 2 і додаючи відстані до вузлів, безпосередньо пов'язаних з вузлом 2, ми бачимо, що вузол 4 може бути досягнутий шляхом подолання 13+6=19 км, а вузол 7 - шляхом подолання 13+17=30 км. Тимчасові мітки для вузлів 4 і 7 поки що показані на рисунку 1.6.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot006}
	\caption{}
	\label{fig:screenshot006}
\end{figure}


З вузлів з часовими мітками (вузли 4, 5 і 7) вибираємо вузол з найменшим відстаннем і присвоюємо йому мітку статусу постійної. Це вузол 5. Позначаємо часовими мітками всі вузли, безпосередньо зв'язані з цими вузлами. При цьому мітка для вузла 4 переглядається, а вузол 6 позначається тимчасовою міткою. Ситуація відображена на рис. 1.7.


\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot007}
	\caption{}
	\label{fig:screenshot007}
\end{figure}

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot008}
	\caption{}
	\label{fig:screenshot008}
\end{figure}

З трьох вузлів, які мають тепер часові мітки, обираємо той, у якого відстань є найменшою. Це вузол 6. Його мітка стає постійною. З вузла 6 ми визначаємо нову тимчасову мітку для вузла 7. Ситуація після цього кроку представлена на рис. 1.8.

Тепер у нас залишилися лише два вузли з часовими мітками. Вузол 4 характеризується найменшою відстанню. Його мітка стає постійною. Оскільки вузол 7 залишається єдиним з тимчасовою міткою і може бути досягнутий безпосередньо з вузла 4, ми порівнюємо вже встановлену відстань у 22 км з відстанню в мітці вузла 4 плюс прямою відстанню між вузлами 4 і 7. Зауважте, що тимчасова мітка [22,6] вже містить у вузлі 7 меншу величину відстані; мітка для вузла 7 тому не змінюється.

Оскільки вузол 7 - останній вузол з часовою міткою, то вона стає постійною. Як тільки всі вузли помічені постійними мітками, ми можемо заявити, що знаємо найкоротші відстані від вузла 1 до будь-якого іншого вузла в мережі. На рис. 17.9 наведена мережа з усіма вузлами, що мають постійні мітки.

Тепер ми можемо використовувати інформацію в постійних мітках для знаходження найкоротшого шляху з вузла 1 до будь-якого іншого вузла. Наприклад, постійна мітка в вузлі 7 говорить нам, що найменше відстань від вузла 1 до вузла 7 становить 22 км. Щоб знайти конкретний шлях, спочатку потрібно знайти сусідній вузол на найкоротшій відстані від вузла 1 до вузла 7. Це вузол 6. До вузла 6 ми на цьому шляху прийшли через вузол 5. Продовжуючи цей процес, ми побачимо, що найкоротший шлях також проходить через вузол 3, а потім веде до вузла 1. Отже, найкоротший шлях від вузла 1 до вузла 7 є шлях 1—3—5—6—7. Використовуючи цей підхід, ми можемо визначити найкоротші шляхи у мережі компанії "Інвест":



\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot009}
	\caption{}
	\label{fig:screenshot009}
\end{figure}
\newpage

\begin{table}[bhtp]
	\centering
	\begin{tabular}{|c|c|c|}
		\hline
		Вузол                                                         & \begin{tabular}[c]{@{}c@{}}Найкоротший шлях\\ з вузла 1\end{tabular}                        & Відстань,км                                                         \\ \hline
		\begin{tabular}[c]{@{}c@{}}2\\ 3\\ 4\\ 5\\ 6\\ 7\end{tabular} & \begin{tabular}[c]{@{}c@{}}1-3-2\\ 1-3\\ 1-3-5-4\\ 1-3-5\\ 1-3-5-6\\ 1-3-5-6-7\end{tabular} & \begin{tabular}[c]{@{}c@{}}13\\ 10\\ 18\\ 14\\ 16\\ 22\end{tabular} \\ \hline
	\end{tabular}
\end{table}


Заключні зауваження:

1. У багатьох випадках метод присвоєння міток застосовується для вирішення задач з мінімізацією часу або витрат. Оскільки алгоритм призначений для знаходження мінімальних значень, він не може застосовуватися, коли критерієм є показник прибутку.

2. У деяких випадках дуги доводиться позначати від'ємними величинами. Якщо ви працюєте з витратами, то від'ємна величина буде означати прибуток. Поданий алгоритм може застосовуватися лише для випадків з позитивними величинами, що характеризують дуги. Для випадків з комбінацією позитивних і від'ємних величин існує більш складна процедура, яка нами не розглядається.

\section{Побудова комунікаційної мережі мінімальної довжини}

Комунікаційна мережа мінімальної довжини, або дерево найкоротших відстаней, - це сукупність дуг мережі, яка має мінімальну загальну довжину і забезпечує досягнення всіх вузлів мережі.

Розглянемо задачу регіонального обчислювального центру.

Південно-Західний регіональний обчислювальний центр повинен встановити спеціальні лінії зв'язку між п'ятьма локальними споживачами та новим центральним комп'ютером. Телефонна компанія береться прокласти нову мережу зв'язку. Проте організація зв'язку - дороге справа. Щоб зменшити витрати, керівництво центру вирішило, що загальна довжина ліній зв'язку в мережі повинна бути мінімальною. Хоча центральний комп'ютер може бути зв'язаний з кожним споживачем окремо, економічніше було б встановити прямий зв'язок з частиною споживачів, а решту зв'язати з центральним комп'ютером через споживачів, які вже отримали цей зв'язок. Визначення такої системи зв'язку мінімальної довжини є прикладом дерева найкоротших відстаней. Мережа у відповідності до цієї задачі з різними можливими альтернативами зв'язку та відстанями показана на рис. 1.10.

Метод, який може бути використаний для вирішення задачі знаходження дерева найкоротших відстаней, дуже простий.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot010}
	\caption{}
	\label{fig:screenshot010}
\end{figure}

\textit{Крок 1.}
Розпочніть довільно з будь-якого вузла і з'єднайте його з найближчим вузлом. Ці два вузли тепер вважаються з'єднаними, а решта - незв'язаними.

\textit{Крок 2.}
Визначте незв'язаний вузол, який найближчий до одного зі з'єднаних вузлів. Якщо два або більше вузлів можна розглядати як найближчі, то виберіть будь-який з них. Додайте цей новий вузол до з'єднаних вузлів. Повторюйте цей крок до тих пір, поки всі вузли не стануть з'єднаними.

Цей мережевий алгоритм легко реалізується, якщо обирати зв'язки безпосередньо на графі мережі.

Звертаючись до мережі зв'язку для регіонального обчислювального центру і починаючи з вузла [, ми знаходимо, що найближчим є вузол 2 з відстанню 20. Використовуючи товсті лінії для позначення дуги, яка забезпечує з'єднання вузлів 1 і 2, ми доходимо до наступного результату, що характеризує крок 1 (рис. 1.11).


\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot011}
	\caption{}
	\label{fig:screenshot011}
\end{figure}


На другому етапі методу ми знаходимо, що непов'язаний вузол, найближчий до одного зі зв'язаних вузлів, є вузол 4 з відстанню 30 км від вузла 1. Додавши вузол 4 до множини зв'язаних вузлів, ми отримуємо наступний результат (рис. 10.12).

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot012}
	\caption{}
	\label{fig:screenshot012}
\end{figure}
\newpage

Повторення кроку, що полягає в додаванні найближчого несполученого вузла до зв'язаного сегменту мережі, дає нам рішення задачі про дерево найкоротших відстаней, показане на рис. 1.13. Повторюйте кроки методу і подивіться, чи отримаєте ви рішення. Мінімальна довжина дерева представлена сумою відстаней на гілках, які утворюють дерево. У даному випадку сума відстаней в мережі регіонального обчислювального центру складає 110 км. Зауважимо, що хоча гілки мережі обчислювального центру вимірюються в кілометрах, інші мережеві моделі можуть характеризуватися зовсім іншими показниками - витратами, часом і т. д. У таких випадках алгоритм дерева найкоротших відстаней буде приводити до оптимального рішення (мінімальні витрати, мінімальний час і т. д.) щодо розглянутого критерію.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot013}
	\caption{}
	\label{fig:screenshot013}
\end{figure}


\section{Задача визначення максимального потоку}

Розглянемо мережу з одним вузлом входу, або джерелом, і одним вузлом виходу, або стоком. При постановці завдання з максимальними потоками ставиться питання: яка максимальна величина потоку (кількість машин, повідомлень, рідини і т. д.), яка може ввійти в мережеву систему і вийти з неї протягом заданого періоду часу? Відповідаючи на це питання, ми намагаємося направити потік через дуги мережі найефективнішим способом. Інтенсивність потоку не є нескінченною через обмеження на різні дуги мережі. Наприклад, автомобільні траси обмежують кількість автомобілів у транспортній системі, розмір трубопроводів обмежує кількість нафти в системі її розподілу. Максимум, або верхнє обмеження на потік, в дузі мережі розглядатимемо як пропускну здатність, або потужність, дузі. Далі ми припускаємо, що потік, що виходить з вузла, дорівнює потоку, що входить у вузол.

На прикладі задачі з максимальними потоками розглянемо систему автомобільних доріг у Бориспольскому районі Київської області. Потік автомобілів у напрямку північно-захід - південно-схід досягає рівня 15 000 автомобілів на годину у найбільш напружений час. Відповідно до літньої програми поточного ремонту доріг, яка передбачає тимчасове закриття сільських доріг і додаткове обмеження швидкості, обласна адміністрація запропонувала мережу альтернативних маршрутів. Альтернативні маршрути включають як інші шосейні дороги, так і міські вулиці Волоколамська. Завдяки різниці в обмеженнях швидкості та склалися автомобільні потоки, потужності дуг мережі в значній мірі залежать від того, які дороги або вулиці вони відображають. Запропонована мережа з показниками потужностей дуг представлена на рис. 1.14.

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot014}
	\caption{}
	\label{fig:screenshot014}
\end{figure}

Потужність потоку залежить від напрямку потоку. Наприклад, дорога, позначена дугою 1—2, має потужність 5000 автомобілів на годину у напрямку від 1 до 2; проектувальники передбачають, що тут буде введено односторонній рух, тому потужність дуги у напрямку від 2 до 1 дорівнює нулю. Оскільки вузол 1 є вхідним і потенційно може створювати автомобільні затори, було б небажано допускати вихідний потік у цей вузол. Проте слід зауважити, що потужності потоків на дугах можуть залежати від напрямків потоків.

Як ми побачимо, алгоритм максимального потоку, представлений у цьому розділі, ґрунтується на здоровому глузді:

1. Знайдіть шлях від вхідного вузла (джерела) до вихідного вузла (стоку), який характеризується відмінними від нуля потужностями на всіх його дугах у напрямку потоку.

2. Збільшуйте потоки на шляху настільки, наскільки це можливо.
Продовжуйте шукати такі шляхи від джерела до стоку, які характеризуються відмінними від нуля потужностями дуг на всьому шляху у напрямку потоку, і збільшуйте потік цих шляхів настільки, наскільки це можливо.

3. Зупиніть процес пошуку, коли стане неможливим подальше знаходження шляху від джерела до стоку з відмінними від нуля потужностями всіх дуг на шляху у напрямку потоку.

4. Перш ніж розглянути деталі алгоритму максимального потоку, обговоримо загально процедуру, яка переконає нас у тому, що вищенаведені кроки призводять до оптимального рішення задачі знаходження максимального потоку від вузла-джерела до вузла-стоку.
\newpage

Процедура дозволяє початковому потоку прийняти альтернативний шлях, використовуючи фіктивні потоки в зворотньому напрямку. Розглянемо, наприклад, дугу 3—6 на малюнку 1.15а.


\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot015}
	\caption{}
	\label{fig:screenshot015}
\end{figure}

Початкова потужність потоку в напрямку 3—6 становить 7000 автомобілів на годину, в той час як у напрямку 6—3 рух транспорту заборонений. Якщо ми припустимо, що у напрямку 6—3 рухатиметься потік 6000 автомобілів на годину, то переглянемо потужності потоку і отримаємо результат, зображений на рис. 1.15б.

Зазначимо, що ми зменшили потужність потоку в напрямку 3—6 на 6000 автомобілів на годину, і одночасно на ту саму величину збільшили потужність потоку в напрямку 6—3. Переглянута потужність потоку, що становить 1000 автомобілів на годину у напрямку 3—6, зараз може інтерпретуватися як залишкова потужність потоку по дузі. Проте помітте, що напрямок 6—3, який раніше мав нульову потужність, тепер характеризується переглянутою потужністю потоку, яка складає 1000 автомобілів на годину. Тепер у цьому напрямку дозволений фіктивний потік до 6000 автомобілів на годину. Фіктивний потік не означає, що автомобілі будуть відправлені в напрямку 6—3, просто потік в напрямку 3—6 буде обмежений у порівнянні з початковим. І результатом введення фіктивного потоку 6—3 буде те, що потік, спочатку направлений по дузі 3—6, буде в певній мірі розподілений між іншими дузами мережі.

Представлений вище процес розподілу потужностей потоків є важливою частиною методу максимального потоку. Наприклад, на попередньому кроці методу ми можемо зафіксувати потік на певній дузі. Пізніше через потоки, визначені на інших дугах, може виявитися бажаним зменшити потік на початковій дузі. Процедура, яку ми описали вище, визначить, у якій мірі наше початкове рішення зафіксувати певний потік слід переглянути, щоб збільшити загальний потік через мережу.

Тепер розглянемо кроки методу максимального потоку.

\textit{Крок 1.}
Знайдіть будь-який шлях від джерела до стоку, який складається з дуг, кожна з яких має напрямок потоку з потужністю, більшою за нуль. Якщо такий шлях не знайдено, то оптимальне рішення досягнуто.

\textit{Крок 2.}
Знайдіть найменше значення потужності дуги \(P_r\) на шляху, вибраному на кроці 1. Збільште потік через мережу, направивши кількість \(P_r\) по шляху, вибраному на кроці 1.

\textit{Крок 3.}
На шляху, вибраному на кроці 1, зменште на \(P_r\) потужності потоків по всіх дугах в напрямку потоку та збільште на P потужності потоків по всіх дугах у зворотньому напрямку.

Перейдіть до кроку 1.

Хоча процедура буде різною залежно від вибору шляхів на кроці 1, проте алгоритм приведе до знаходження максимального потоку. Наші обчислення відносно мережі доріг будуть такими:

\textit{Ітерація 1.}
Вибрано шлях 1—3—6—7. \(P_r\), визначена дугою 1-3, складає 6. Переглянута мережа показана на рис. 1.16.

\textit{Ітерація 2.}
Вибрано шлях 1—2—5—7. \(P_r\), визначена дугою 2—5, складає 3 (рис. 1.16).

Загальний потік через мережу може бути знайдений шляхом сумування P1 та P2 на кожній ітерації. Виконаємо ще три ітерації.

\textit{Ітерація 3.}
Вибрано шлях 1—2—3—5—7. \(P_r\), визначена дугою 3—5, складає 2.

\textit{Ітерація 4.}
Вибрано шлях 1—4—6—7. \(P_r\), визначена дугою 6—7, складає 1.

\newpage

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot016}
	\caption{}
	\label{fig:screenshot016}
\end{figure}

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot017}
	\caption{}
	\label{fig:screenshot017}
\end{figure}

\textit{Ітерація 5.}
Вибрано шлях 1—4—6—5-7. \(P_r\), визначена дугою 6—5, складає 1.

Тепер ми маємо спільний поток, що дорівнює 13 тис. автомобілей/год, і наступні переглянуті показники потужності дуг (рис. 1.18)


\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot018}
	\caption{}
	\label{fig:screenshot018}
\end{figure}
\newpage

Чи існують ще шляхи від вузла 1 до вузла 7, які мають у напрямку потоку потужність, що перевищує 0? Спробуйте 1—4—6—3—5—7 з потоком \(P_r\), який визначається дугою 3—5. Це збільшує потік до 14 тис. автомобілів на годину. Однак з переглянутої нижче зміненої мережі можна побачити, що не існує шляхів з вузла 1 до вузла 7 з потужністю, що перевищує нуль на всіх дугах; отже, 14 тис. — це максимальний потік через мережу (рис. 1.19).


\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot019}
	\caption{}
	\label{fig:screenshot019}
\end{figure}


Зверніть увагу, що потік у 1000 автомобілів за годину в напрямку 6-3 був дозволений на ітерації 6. Однак зі стартової мережі ми знаємо, що потік у напрямку 6-3 дорівнює нулю; таким чином, 1 тис. одиниць на годину в напрямку 6-3 є фіктивним потоком. Реальний ефект цього потоку полягає в тому, що | тис. одиниць потоку, спочатку наданих дузі 3-6 на ітерації 1, зараз призначаються дузі 3-5, щоб зробити можливим додавання цих 1 тис. одиниць до загального потоку через мережу. Тепер давайте визначимо величину та напрямок потоку на кожній дузі — так, щоб досягти загальної величини у 14 тис. автомобілів за годину.

Потоки по дугам для досягнення максимального загального потоку можуть бути знайдені шляхом порівняння кінцевих потужностей потоків по дугам з початковими потужностями. Якщо кінцева потужність потоку менше початкової потужності потоку, потік відбувається по дузі з величиною, що дорівнює різниці між початковою та кінцевою потужностями потоку. Розглянемо, наприклад, дугу 3-6 з початковою та кінцевою потужностями, зазначеними нижче.

Оскільки кінцева потужність потоку в напрямку 3-6 менше початкової потужності потоку, дуга має величину потоку, рівну 7 - 2 = 5 у напрямку 3-6. Цей потік по дузі виражений наступним чином (рис. 1.20а та 1.20б)

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot020}
	\caption{}
	\label{fig:screenshot020}
\end{figure}

Порівнюючи кінцеві та початкові потужності потоку для всіх дуг мережі, ми отримуємо кінцеву модель потоків (рис. 1.21).

\begin{figure}[bhtp]
	\centering
	\includegraphics[width=0.7\linewidth]{screenshot021}
	\caption{}
	\label{fig:screenshot021}
\end{figure}

Результати аналізу максимального потоку показують, що запланована мережа доріг не зможе витримати пікового навантаження у 15 тисяч автомобілів на годину. При плануванні транспортування необхідно або розширити мережу доріг і збільшити діючі потужності потоків на дугах, або підготуватися до серйозних проблем, пов'язаних з утворенням автомобільних заторів. Якщо мережу буде розширено або модифіковано, то наступний аналіз максимального потоку дозволить визначити, наскільки досягнуте поліпшення.

\end{document}
